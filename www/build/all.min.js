!function(){"use strict";function e(e,t,r,o){function n(e,o){var n=r.checkUserAuthenticated();"login"===o.name&&n?(e.preventDefault(),t.go("courses.list")):void 0!==o.data&&o.data.requireAuth&&!n&&(e.preventDefault(),t.go("login"))}e.$on("$stateChangeStart",n),e.$on("$stateChangeSuccess",o.updateBreadcrumbs)}angular.module("VideoPortalApp",["ngResource","ngCookies","ui.router","ui.bootstrap"]).run(e),e.$inject=["$rootScope","$state","authenticationService","breadcrumbsService"]}(),function(){"use strict";function e(e,n){n.when("/courses","/courses/list"),n.otherwise("/login"),e.state("login",{url:"/login",templateUrl:"components/authentication/login.tpl.html",controller:"Login",controllerAs:"loginVm",data:{label:"Login"}}).state("courses",{url:"/courses",template:"<div ui-view></div>",data:{requireAuth:!0,label:"Courses"}}).state("courses.list",{url:"/list",templateUrl:"components/courses/courses.tpl.html",controller:"Courses",controllerAs:"coursesVm",data:{requireAuth:!0,label:"List"}}).state("courses.new",{url:"/new",templateUrl:"components/courses/course-edit/course-edit.tpl.html",controller:"CourseEdit",controllerAs:"courseVm",data:{requireAuth:!0,label:"New"},resolve:{authors:t,course:o}}).state("courses.edit",{url:"/{id:int}",templateUrl:"components/courses/course-edit/course-edit.tpl.html",controller:"CourseEdit",controllerAs:"courseVm",data:{requireAuth:!0,label:"{{ course.title }}",interpolate:!0},resolve:{authors:t,course:r}})}function t(e){return e.getAll()}function r(e,t,r,o){return o.get(t.id).then(function(e){return e})["catch"](function(t){r.warn(t),e.go("courses.list")})}function o(){return{duration:0,authors:[]}}angular.module("VideoPortalApp").config(e),e.$inject=["$stateProvider","$urlRouterProvider"],t.$inject=["authorService"],r.$inject=["$state","$stateParams","$log","courseService"]}(),function(){"use strict";function e(e,t){function r(){var t=e.get(a);return l.userAuthenticated=void 0!==t,l.userAuthenticated}function o(){var r=e.get(a);return t.get(r).then(function(e){return l.user=e,l.user})}function n(e,r){return t.getAll().then(function(t){var o=i(t,e,r),n=void 0!==o;return n&&(s(o.id),l.user=o,l.userAuthenticated=!0),n})}function u(){c(),l.user={},l.userAuthenticated=!1}function i(e,t,r){for(var o=0;o<e.length;o++)if(e[o].username===t&&e[o].password===r)return e[o];return void 0}function s(t){e.put(a,t)}function c(){e.remove(a)}var a="USER_DATA",l={userAuthenticated:!1,user:{}};return{authData:l,checkUserAuthenticated:r,getCurrentUserInfo:o,signIn:n,signOut:u}}angular.module("VideoPortalApp").factory("authenticationService",e),e.$inject=["$cookies","userService"]}(),function(){"use strict";function e(e,t){function r(e){n.alerts.splice(e,1)}function o(r){function o(t){t?e.go("courses.list"):(n.alerts.push({type:"danger",msg:"Wrong login or password"}),r.password="")}return t.signIn(r.login,r.password).then(o)}var n=this;n.alerts=[],n.closeAlert=r,n.signIn=o}angular.module("VideoPortalApp").controller("Login",e),e.$inject=["$state","authenticationService"]}(),function(){"use strict";function e(e){function t(e){return o.get({id:e}).$promise}function r(){return o.query().$promise}var o=e("/data/users/:id");return{get:t,getAll:r}}angular.module("VideoPortalApp").factory("userService",e),e.$inject=["$resource"]}(),function(){"use strict";function e(e){function t(e){return e.id=i(),s.save({id:e.id},e).$promise}function r(e){return s.get({id:e}).$promise}function o(){return s.query().$promise}function n(e){return s["delete"]({id:e}).$promise}function u(e){return s.update({id:e.id},e).$promise}function i(){return Math.floor(1e5*Math.random())}var s=e("/data/courses/:id",{},{update:{method:"PUT"}});return{add:t,get:r,getAll:o,remove:n,update:u}}angular.module("VideoPortalApp").factory("courseService",e),e.$inject=["$resource"]}(),function(){"use strict";function e(e,t){function r(){return t.getAll().then(function(e){u.courses=e})}function o(e){u.search=e}function n(r){return e.open({templateUrl:"removeConfirmation.html",controller:"confirmDeleteModal as modalVm",resolve:{course:function(){return u.courses[r]}}}).result.then(t.remove).then(function(){u.courses.splice(r,1)})}var u=this;u.applySearchFilter=o,u.removeCourse=n,r()}angular.module("VideoPortalApp").controller("Courses",e),e.$inject=["$uibModal","courseService"]}(),function(){"use strict";function e(e,t){function r(){e.dismiss("cancel")}function o(){e.close(n.course.id)}var n=this;n.cancel=r,n.course=t,n.ok=o}angular.module("VideoPortalApp").controller("confirmDeleteModal",e),e.$inject=["$uibModalInstance","course"]}(),function(){"use strict";function e(e,t,r){function o(){t.signOut(),e.go("login")}function n(){var e=t.checkUserAuthenticated();e&&t.getCurrentUserInfo()}var u=this;u.authData=t.authData,u.breadcrumbs=r.breadcrumbs,u.signOut=o,n()}angular.module("VideoPortalApp").controller("Main",e),e.$inject=["$state","authenticationService","breadcrumbsService"]}(),function(){"use strict";function e(e){function t(){return r.query().$promise}var r=e("/data/authors");return{getAll:t}}angular.module("VideoPortalApp").factory("authorService",e),e.$inject=["$resource"]}(),function(){"use strict";function e(e,t,r,o,n){function u(){e.go("courses.list")}function i(){var o=s.form.$valid&&s.course.authors.length>0;o?(void 0===s.course.id?r.add(s.course):r.update(s.course),e.go("courses.list")):t.open({templateUrl:"validationDialog.html"})}var s=this;s.authors=o,s.cancel=u,s.course=n,s.save=i}angular.module("VideoPortalApp").controller("CourseEdit",e),e.$inject=["$state","$uibModal","courseService","authors","course"]}(),function(){"use strict";function e(){function e(e){return e>=48&&57>=e||e>=96&&105>=e}function t(e){return 190===e}function r(e){var t=[8,9,35,36,37,38,39,40,46,116];return-1!==t.indexOf(e)}var o={restrict:"A",link:function(o,n){n.on("keydown",function(o){var n=o.keyCode,u=e(n),i=t(n),s=r(n);return u||i||s})}};return o}angular.module("VideoPortalApp").directive("dateValidation",e)}(),function(){"use strict";function e(){var e={restrict:"A",templateUrl:"shared/authors-selector/authors-selector.tpl.html",scope:{allAuthors:"=",courseAuthors:"="},controller:t,controllerAs:"vm",bindToController:!0};return e}function t(){function e(){if(n.courseAuthors)for(var e=0;e<n.courseAuthors.length;e++){var t=o(n.allAuthors,n.courseAuthors[e].id);n.allAuthors.splice(t,1)}}function t(e){if(void 0!==e)for(var t=0;t<e.length;t++){var r=o(n.allAuthors,+e[t]);-1!==r&&(n.courseAuthors.push(n.allAuthors[r]),n.allAuthors.splice(r,1))}}function r(e){if(void 0!==e)for(var t=0;t<e.length;t++){var r=o(n.courseAuthors,+e[t]);-1!==r&&(n.allAuthors.push(n.courseAuthors[r]),n.courseAuthors.splice(r,1))}}function o(e,t){for(var r=0;r<e.length;r++)if(e[r].id===t)return r;return-1}var n=this;n.addAuthors=t,n.removeAuthors=r,e()}angular.module("VideoPortalApp").directive("authorsSelector",e)}(),function(){"use strict";function e(){var e={restrict:"EA",templateUrl:"shared/breadcrumbs/breadcrumbs.tpl.html",scope:{breadcrumbs:"="}};return e}angular.module("VideoPortalApp").directive("breadcrumbs",e)}(),function(){"use strict";function e(e,t){function r(){o(),u.unshift(n(e.$current));for(var t=e.$current.parent;void 0!==t.data;)u.unshift(n(t)),t=t.parent}function o(){u.splice(0,u.length)}function n(e){var r=e.data.label;return e.data.interpolate&&(r=t(r)(e.locals.globals)),{label:r,state:e.name}}var u=[];return{breadcrumbs:u,updateBreadcrumbs:r}}angular.module("VideoPortalApp").factory("breadcrumbsService",e),e.$inject=["$state","$interpolate"]}(),function(){"use strict";function e(){var e={restrict:"EA",templateUrl:"shared/duration-converter/duration-converter.tpl.html",scope:{duration:"="}};return e}angular.module("VideoPortalApp").directive("durationConverter",e)}(),function(){"use strict";function e(){return function(e){var t="";if(e){var r=Math.floor(e/60),o=e%60;0!==r&&(t=r+" hour "),0!==o&&(t+=o+" min")}return t}}angular.module("VideoPortalApp").filter("minutesToHours",e)}(),function(){"use strict";function e(){return function(e,t){return t?(t=t.toLowerCase(),e.filter(function(e){var r=-1!==e.title.toLocaleLowerCase().indexOf(t),o=-1!==e.date.indexOf(t);return r||o})):e}}angular.module("VideoPortalApp").filter("searchCourse",e)}();